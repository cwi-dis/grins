#! /bin/sh

case `uname -sr` in
IRIX\ 5.*)	ARCH=irix5;;
SunOS\ 5.*)	ARCH=sunos5;;
*)		echo "$0: unknown architecture" >&2; exit 1;;
esac

prog="$0"
case "$prog" in
*/*)	dir=`dirname "$prog"`;;
*)	IFS=:
	for dir in $PATH
	do
		[ -x "${dir:-.}/$prog" ] && break
	done
	dir="${dir:-.}"
	;;
esac
IFS=' 	
'
case "$dir" in
/*)	;;
*)	dir=`pwd`/$dir;;
esac

while :
do
	case "$dir" in
	*/.)	dir=`dirname "$dir"`;;
	*)	break;;
	esac
done

case "$dir" in
*/bin)	dir=`dirname "$dir"`;;
esac

for sub in player common video python lib mmpython
do
	if [ ! -d "$dir/$sub" ]
	then
		echo "$0: cannot find proper directory" >&2
		exit 1
	fi
done

python="$dir/mmpython/$ARCH/python"

CMIF="$dir"
export CMIF

PYTHONPATH="$CMIF/player:$CMIF/common:$CMIF/lib:$CMIF/video:$dir/python:$dir/python/test:$dir/python/$ARCH:$dir/python/X11:$dir/python/img"
export PYTHONPATH

PATH="$PATH:$dir/demo/amsterdam"
export PATH

CMIF_USE_X=1
export CMIF_USE_X

exec $python -c "import main" ${1+"$@"}
